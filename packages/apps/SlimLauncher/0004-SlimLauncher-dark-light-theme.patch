From 4e312586580bce0a6a734d0facb8384d95504d30 Mon Sep 17 00:00:00 2001
From: scoute-dich <baumann.juergen@posteo.de>
Date: Sun, 28 May 2017 09:42:26 +0200
Subject: [PATCH 4/5] SlimLauncher: dark/light theme

Change-Id: I0af7bbbb1e440c9c142ec7d7edadd666fe1bbeda
---
 res/drawable-v21/quantum_panel.xml                 | 22 -------
 res/drawable-v21/quantum_panel_dark.xml            | 22 -------
 res/drawable/quantum_panel.xml                     |  8 ++-
 res/drawable/quantum_panel_dark.xml                |  8 ++-
 res/drawable/quantum_panel_light.xml               | 22 +++++++
 res/drawable/quantum_panel_shape_light.xml         | 22 +++++++
 res/layout/all_apps.xml                            |  2 +-
 res/layout/all_apps_empty_search.xml               |  2 +-
 res/layout/all_apps_empty_search_light.xml         | 31 +++++++++
 res/layout/all_apps_icon_light.xml                 | 27 ++++++++
 res/layout/folder_application_light.xml            | 19 ++++++
 res/layout/qsb_default_view_light.xml              | 54 ++++++++++++++++
 res/layout/user_folder_icon_normalized_light.xml   | 73 ++++++++++++++++++++++
 res/layout/user_folder_light.xml                   | 73 ++++++++++++++++++++++
 res/values/colors.xml                              | 13 ++++
 res/values/styles.xml                              | 21 +++++++
 res/xml/general_preferences.xml                    | 22 +++++++
 res/xml/homescreen_preferences.xml                 |  6 --
 res/xml/preferences.xml                            | 10 +--
 src/com/android/launcher3/Hotseat.java             | 17 ++++-
 src/com/android/launcher3/IconCache.java           | 13 +++-
 src/com/android/launcher3/QsbContainerView.java    | 25 +++++++-
 .../launcher3/allapps/AllAppsContainerView.java    |  9 +++
 .../launcher3/allapps/AllAppsGridAdapter.java      | 28 +++++++--
 .../allapps/AllAppsTransitionController.java       | 15 ++++-
 src/com/android/launcher3/folder/Folder.java       | 19 +++++-
 .../android/launcher3/folder/FolderPagedView.java  | 19 +++++-
 .../slim/launcher/settings/GeneralFragment.java    |  4 ++
 src/org/slim/launcher/settings/SettingsKeys.java   |  7 ++-
 .../slim/launcher/settings/SettingsProvider.java   |  4 ++
 30 files changed, 540 insertions(+), 77 deletions(-)
 delete mode 100644 res/drawable-v21/quantum_panel.xml
 delete mode 100644 res/drawable-v21/quantum_panel_dark.xml
 create mode 100644 res/drawable/quantum_panel_light.xml
 create mode 100644 res/drawable/quantum_panel_shape_light.xml
 create mode 100644 res/layout/all_apps_empty_search_light.xml
 create mode 100644 res/layout/all_apps_icon_light.xml
 create mode 100644 res/layout/folder_application_light.xml
 create mode 100644 res/layout/qsb_default_view_light.xml
 create mode 100644 res/layout/user_folder_icon_normalized_light.xml
 create mode 100644 res/layout/user_folder_light.xml
 create mode 100644 res/xml/general_preferences.xml

diff --git a/res/drawable-v21/quantum_panel.xml b/res/drawable-v21/quantum_panel.xml
deleted file mode 100644
index d1c0783..0000000
--- a/res/drawable-v21/quantum_panel.xml
+++ /dev/null
@@ -1,22 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-     Copyright (C) 2015 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<inset xmlns:android="http://schemas.android.com/apk/res/android"
-    android:drawable="@drawable/quantum_panel_shape"
-    android:insetBottom="@dimen/quantum_panel_outer_padding"
-    android:insetLeft="@dimen/quantum_panel_outer_padding"
-    android:insetRight="@dimen/quantum_panel_outer_padding"
-    android:insetTop="@dimen/quantum_panel_outer_padding" />
diff --git a/res/drawable-v21/quantum_panel_dark.xml b/res/drawable-v21/quantum_panel_dark.xml
deleted file mode 100644
index 405ad51..0000000
--- a/res/drawable-v21/quantum_panel_dark.xml
+++ /dev/null
@@ -1,22 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<!--
-     Copyright (C) 2015 The Android Open Source Project
-
-     Licensed under the Apache License, Version 2.0 (the "License");
-     you may not use this file except in compliance with the License.
-     You may obtain a copy of the License at
-
-          http://www.apache.org/licenses/LICENSE-2.0
-
-     Unless required by applicable law or agreed to in writing, software
-     distributed under the License is distributed on an "AS IS" BASIS,
-     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-     See the License for the specific language governing permissions and
-     limitations under the License.
--->
-<inset xmlns:android="http://schemas.android.com/apk/res/android"
-    android:drawable="@drawable/quantum_panel_shape_dark"
-    android:insetBottom="@dimen/quantum_panel_outer_padding"
-    android:insetLeft="@dimen/quantum_panel_outer_padding"
-    android:insetRight="@dimen/quantum_panel_outer_padding"
-    android:insetTop="@dimen/quantum_panel_outer_padding" />
diff --git a/res/drawable/quantum_panel.xml b/res/drawable/quantum_panel.xml
index 1f4fb71..d1c0783 100644
--- a/res/drawable/quantum_panel.xml
+++ b/res/drawable/quantum_panel.xml
@@ -14,5 +14,9 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<nine-patch xmlns:android="http://schemas.android.com/apk/res/android"
-    android:src="@drawable/quantum_panel_bitmap" />
+<inset xmlns:android="http://schemas.android.com/apk/res/android"
+    android:drawable="@drawable/quantum_panel_shape"
+    android:insetBottom="@dimen/quantum_panel_outer_padding"
+    android:insetLeft="@dimen/quantum_panel_outer_padding"
+    android:insetRight="@dimen/quantum_panel_outer_padding"
+    android:insetTop="@dimen/quantum_panel_outer_padding" />
diff --git a/res/drawable/quantum_panel_dark.xml b/res/drawable/quantum_panel_dark.xml
index 6642e78..405ad51 100644
--- a/res/drawable/quantum_panel_dark.xml
+++ b/res/drawable/quantum_panel_dark.xml
@@ -14,5 +14,9 @@
      See the License for the specific language governing permissions and
      limitations under the License.
 -->
-<nine-patch xmlns:android="http://schemas.android.com/apk/res/android"
-    android:src="@drawable/quantum_panel_dark_bitmap" />
+<inset xmlns:android="http://schemas.android.com/apk/res/android"
+    android:drawable="@drawable/quantum_panel_shape_dark"
+    android:insetBottom="@dimen/quantum_panel_outer_padding"
+    android:insetLeft="@dimen/quantum_panel_outer_padding"
+    android:insetRight="@dimen/quantum_panel_outer_padding"
+    android:insetTop="@dimen/quantum_panel_outer_padding" />
diff --git a/res/drawable/quantum_panel_light.xml b/res/drawable/quantum_panel_light.xml
new file mode 100644
index 0000000..c6fdd42
--- /dev/null
+++ b/res/drawable/quantum_panel_light.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<inset xmlns:android="http://schemas.android.com/apk/res/android"
+    android:drawable="@drawable/quantum_panel_shape_light"
+    android:insetBottom="@dimen/quantum_panel_outer_padding"
+    android:insetLeft="@dimen/quantum_panel_outer_padding"
+    android:insetRight="@dimen/quantum_panel_outer_padding"
+    android:insetTop="@dimen/quantum_panel_outer_padding" />
diff --git a/res/drawable/quantum_panel_shape_light.xml b/res/drawable/quantum_panel_shape_light.xml
new file mode 100644
index 0000000..25ec3f1
--- /dev/null
+++ b/res/drawable/quantum_panel_shape_light.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+       android:shape="rectangle">
+    <solid android:color="@color/quantum_panel_bg_color_light" />
+    <corners
+        android:radius="2dp" />
+</shape>
\ No newline at end of file
diff --git a/res/layout/all_apps.xml b/res/layout/all_apps.xml
index 0039fd8..23e71fb 100644
--- a/res/layout/all_apps.xml
+++ b/res/layout/all_apps.xml
@@ -77,7 +77,7 @@
                 android:maxLines="1"
                 android:scrollHorizontally="true"
                 android:singleLine="true"
-                android:textColor="#fafafa"
+                android:textColor="@color/quantum_panel_text_color"
                 android:hint="@string/all_apps_search_bar_hint"
                 android:textColorHint="@drawable/all_apps_search_hint"
                 android:textSize="16sp" />
diff --git a/res/layout/all_apps_empty_search.xml b/res/layout/all_apps_empty_search.xml
index 10899d5..d13a823 100644
--- a/res/layout/all_apps_empty_search.xml
+++ b/res/layout/all_apps_empty_search.xml
@@ -25,7 +25,7 @@
     android:paddingRight="16dp"
     android:fontFamily="sans-serif-medium"
     android:textSize="14sp"
-    android:textColor="#ffffff"
+    android:textColor="@color/quantum_panel_text_color"
     android:alpha="0.56"
     android:focusable="false" />
 
diff --git a/res/layout/all_apps_empty_search_light.xml b/res/layout/all_apps_empty_search_light.xml
new file mode 100644
index 0000000..bb7d5b1
--- /dev/null
+++ b/res/layout/all_apps_empty_search_light.xml
@@ -0,0 +1,31 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<TextView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/empty_text"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:gravity="start"
+    android:paddingTop="@dimen/all_apps_empty_search_message_top_offset"
+    android:paddingBottom="8dp"
+    android:paddingLeft="16dp"
+    android:paddingRight="16dp"
+    android:fontFamily="sans-serif-medium"
+    android:textSize="14sp"
+    android:textColor="@color/quantum_panel_text_color_light"
+    android:alpha="0.56"
+    android:focusable="false" />
+
diff --git a/res/layout/all_apps_icon_light.xml b/res/layout/all_apps_icon_light.xml
new file mode 100644
index 0000000..0b2b867
--- /dev/null
+++ b/res/layout/all_apps_icon_light.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<com.android.launcher3.BubbleTextView
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:launcher="http://schemas.android.com/apk/res-auto"
+    style="@style/Icon.AllApps.Light"
+    android:id="@+id/icon"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:layout_gravity="center"
+    android:focusable="true"
+    launcher:iconDisplay="all_apps"
+    launcher:centerVertically="true" />
+
diff --git a/res/layout/folder_application_light.xml b/res/layout/folder_application_light.xml
new file mode 100644
index 0000000..a1d0e2d
--- /dev/null
+++ b/res/layout/folder_application_light.xml
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2014 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<com.android.launcher3.BubbleTextView xmlns:android="http://schemas.android.com/apk/res/android"
+   style="@style/Icon.Folder.Light"
+   android:focusable="true" />
diff --git a/res/layout/qsb_default_view_light.xml b/res/layout/qsb_default_view_light.xml
new file mode 100644
index 0000000..7591ba7
--- /dev/null
+++ b/res/layout/qsb_default_view_light.xml
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2016 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
+             android:layout_width="match_parent"
+             android:layout_height="match_parent">
+
+    <LinearLayout
+        android:layout_width="match_parent"
+        android:layout_height="48dp"
+        android:layout_margin="16dp"
+        android:layout_gravity="center_vertical"
+        android:background="@drawable/quantum_panel_shape"
+        android:elevation="2dp"
+        android:orientation="horizontal">
+
+        <TextView
+            android:layout_width="0dp"
+            android:id="@+id/btn_qsb_search"
+            android:layout_height="match_parent"
+            android:layout_weight="1"
+            android:gravity="center_vertical"
+            android:paddingStart="16dp"
+            android:text="@string/abandoned_search"
+            android:textColor="@color/quantum_panel_text_color_light"
+            android:textAppearance="?android:textAppearanceMedium"
+            android:clickable="true"
+            android:background="?android:attr/selectableItemBackground" />
+        <ImageView
+            android:layout_width="48dp"
+            android:id="@+id/btn_qsb_setup"
+            android:clickable="true"
+            android:visibility="gone"
+            android:layout_height="match_parent"
+            android:src="@drawable/ic_setting"
+            android:tint="@color/quantum_panel_text_color_light"
+            android:contentDescription="@string/gadget_setup_text"
+            android:padding="8dp"
+            android:background="?android:attr/selectableItemBackground" />
+    </LinearLayout>
+</FrameLayout>
\ No newline at end of file
diff --git a/res/layout/user_folder_icon_normalized_light.xml b/res/layout/user_folder_icon_normalized_light.xml
new file mode 100644
index 0000000..3ca4c6d
--- /dev/null
+++ b/res/layout/user_folder_icon_normalized_light.xml
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<com.android.launcher3.folder.Folder xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:launcher="http://schemas.android.com/apk/res-auto"
+    android:layout_width="wrap_content"
+    android:layout_height="wrap_content"
+    android:background="@drawable/quantum_panel_light"
+    android:elevation="5dp"
+    android:orientation="vertical" >
+
+    <com.android.launcher3.folder.FolderPagedView
+        android:id="@+id/folder_content"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:paddingLeft="8dp"
+        android:paddingRight="8dp"
+        android:paddingTop="6dp"
+        launcher:pageIndicator="@+id/folder_page_indicator" />
+
+    <LinearLayout
+        android:id="@+id/folder_footer"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:clipChildren="false"
+        android:orientation="horizontal"
+        android:paddingLeft="12dp"
+        android:paddingRight="12dp" >
+
+        <com.android.launcher3.ExtendedEditText
+            android:id="@+id/folder_name"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center_vertical"
+            android:layout_weight="1"
+            android:background="#00000000"
+            android:fontFamily="sans-serif-condensed"
+            android:textStyle="bold"
+            android:gravity="center_horizontal"
+            android:hint="@string/folder_hint_text"
+            android:imeOptions="flagNoExtractUi"
+            android:paddingBottom="@dimen/folder_label_padding_bottom"
+            android:paddingTop="@dimen/folder_label_padding_top"
+            android:singleLine="true"
+            android:textColor="#EE777777"
+            android:textColorHighlight="#ffCCCCCC"
+            android:textColorHint="#ff808080"
+            android:textSize="@dimen/folder_label_text_size" />
+
+        <com.android.launcher3.pageindicators.PageIndicatorDots
+            android:id="@+id/folder_page_indicator"
+            android:layout_gravity="center_vertical"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:elevation="1dp"
+            />
+
+    </LinearLayout>
+
+</com.android.launcher3.folder.Folder>
diff --git a/res/layout/user_folder_light.xml b/res/layout/user_folder_light.xml
new file mode 100644
index 0000000..2c340d3
--- /dev/null
+++ b/res/layout/user_folder_light.xml
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+     Copyright (C) 2015 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<com.android.launcher3.folder.Folder xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:launcher="http://schemas.android.com/apk/res-auto"
+    android:layout_width="wrap_content"
+    android:layout_height="wrap_content"
+    android:background="@drawable/quantum_panel_light"
+    android:elevation="5dp"
+    android:orientation="vertical" >
+
+    <com.android.launcher3.folder.FolderPagedView
+        android:id="@+id/folder_content"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:paddingLeft="8dp"
+        android:paddingRight="8dp"
+        android:paddingTop="6dp"
+        launcher:pageIndicator="@+id/folder_page_indicator" />
+
+    <LinearLayout
+        android:id="@+id/folder_footer"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:clipChildren="false"
+        android:orientation="horizontal"
+        android:paddingLeft="12dp"
+        android:paddingRight="12dp" >
+
+        <com.android.launcher3.ExtendedEditText
+            android:id="@+id/folder_name"
+            android:layout_width="0dp"
+            android:layout_height="wrap_content"
+            android:layout_gravity="center_vertical"
+            android:layout_weight="1"
+            android:background="#00000000"
+            android:fontFamily="sans-serif-condensed"
+            android:gravity="center_horizontal"
+            android:hint="@string/folder_hint_text"
+            android:imeOptions="flagNoExtractUi"
+            android:paddingBottom="@dimen/folder_label_padding_bottom"
+            android:paddingTop="@dimen/folder_label_padding_top"
+            android:singleLine="true"
+            android:textColor="#ff777777"
+            android:includeFontPadding="false"
+            android:textColorHighlight="#ffCCCCCC"
+            android:textColorHint="#ff808080"
+            android:textSize="@dimen/folder_label_text_size" />
+
+        <com.android.launcher3.pageindicators.PageIndicatorDots
+            android:id="@+id/folder_page_indicator"
+            android:layout_gravity="center_vertical"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:elevation="1dp"
+            />
+
+    </LinearLayout>
+
+</com.android.launcher3.folder.Folder>
\ No newline at end of file
diff --git a/res/values/colors.xml b/res/values/colors.xml
index 2ce240b..c9d6d84 100644
--- a/res/values/colors.xml
+++ b/res/values/colors.xml
@@ -54,4 +54,17 @@
     <color name="hidden_false">#00424242</color>
 
 
+
+    <color name="quantum_panel_text_color_light">#FF666666</color>
+    <color name="quantum_panel_bg_color_light">#FFF5F5F5</color>
+
+    <color name="outline_color_light">#FFFFFFFF</color>
+    <color name="all_apps_divider_color_light">#1E000000</color>
+    <color name="all_apps_caret_color_light">#FFFFFFFF</color>
+    <color name="all_apps_caret_shadow_color_light">#22000000</color>
+    <color name="all_apps_container_color_light">#FFF2F2F2</color>
+    <color name="all_apps_navbar_color_light">#28000000</color>
+
+
+
 </resources>
diff --git a/res/values/styles.xml b/res/values/styles.xml
index 8d41cdf..d6d8e89 100644
--- a/res/values/styles.xml
+++ b/res/values/styles.xml
@@ -70,6 +70,16 @@
         <item name="customShadows">false</item>
     </style>
 
+    <style name="Icon.AllApps.Light">
+        <item name="android:background">@null</item>
+        <item name="android:textColor">@color/quantum_panel_text_color_light</item>
+        <item name="android:drawablePadding">@dimen/dynamic_grid_icon_drawable_padding</item>
+        <item name="android:shadowRadius">0</item>
+        <item name="android:paddingLeft">4dp</item>
+        <item name="android:paddingRight">4dp</item>
+        <item name="customShadows">false</item>
+    </style>
+
     <style name="Icon.Folder">
         <item name="android:background">@null</item>
         <item name="android:textColor">@color/quantum_panel_text_color</item>
@@ -81,6 +91,17 @@
         <item name="iconDisplay">folder</item>
     </style>
 
+    <style name="Icon.Folder.Light">
+        <item name="android:background">@null</item>
+        <item name="android:textColor">@color/quantum_panel_text_color_light</item>
+        <item name="android:shadowRadius">0</item>
+        <item name="android:textSize">@dimen/folder_child_text_size</item>
+        <item name="android:gravity">center_horizontal</item>
+        <item name="android:includeFontPadding">false</item>
+        <item name="customShadows">false</item>
+        <item name="iconDisplay">folder</item>
+    </style>
+
     <style name="Icon.DeepShortcut">
         <item name="android:gravity">start|center_vertical</item>
         <item name="android:textAlignment">viewStart</item>
diff --git a/res/xml/general_preferences.xml b/res/xml/general_preferences.xml
new file mode 100644
index 0000000..79a0484
--- /dev/null
+++ b/res/xml/general_preferences.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="utf-8"?>
+
+<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:launcher="http://schemas.android.com/apk/res-auto"
+    android:title="General Settings">
+
+
+    <CheckBoxPreference
+        android:title="Fullscreen"
+        android:summary="Enable fullscreen mode"
+        android:key="show_fullscreen"
+        android:defaultValue="false" />
+
+    <CheckBoxPreference
+        android:title="Light theme"
+        android:summary="Use light theme as dafault"
+        android:key="light_theme"
+        android:defaultValue="false" />
+
+
+
+</PreferenceScreen>
diff --git a/res/xml/homescreen_preferences.xml b/res/xml/homescreen_preferences.xml
index b2d5d08..6200403 100644
--- a/res/xml/homescreen_preferences.xml
+++ b/res/xml/homescreen_preferences.xml
@@ -15,10 +15,4 @@
         launcher:pickerTitle1="@string/grid_size_rows_title"
         launcher:pickerTitle2="@string/grid_size_columns_title" />
 
-    <CheckBoxPreference
-        android:title="Fullscreen"
-        android:summary="Enable fullscreen mode"
-        android:key="show_fullscreen"
-        android:defaultValue="false" />
-
 </PreferenceScreen>
diff --git a/res/xml/preferences.xml b/res/xml/preferences.xml
index 59ad16a..c08b81b 100644
--- a/res/xml/preferences.xml
+++ b/res/xml/preferences.xml
@@ -2,6 +2,11 @@
 <preference-headers xmlns:android="http://schemas.android.com/apk/res/android">
 
     <header
+        android:fragment="org.slim.launcher.settings.GeneralFragment"
+        android:id="@+id/pref_general"
+        android:title="General settings" />
+
+    <header
         android:fragment="org.slim.launcher.settings.HomescreenFragment"
         android:id="@+id/pref_homescreen"
         android:title="@string/homescreen_title" />
@@ -27,11 +32,6 @@
         android:title="@string/gestures_title" />
 
     <!--<header
-        android:fragment="com.slim.slimlauncher.settings.GeneralFragment"
-        android:id="@+id/pref_general"
-        android:title="@string/general_title" />
-
-    <header
         android:id="@+id/slim_application_version"
         android:summary="@string/slim_application_copyright" />-->
 
diff --git a/src/com/android/launcher3/Hotseat.java b/src/com/android/launcher3/Hotseat.java
index 87dfa4f..ed3789f 100644
--- a/src/com/android/launcher3/Hotseat.java
+++ b/src/com/android/launcher3/Hotseat.java
@@ -36,6 +36,9 @@ import com.android.launcher3.logging.UserEventDispatcher;
 import com.android.launcher3.userevent.nano.LauncherLogProto;
 import com.android.launcher3.userevent.nano.LauncherLogProto.Target;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 public class Hotseat extends FrameLayout
         implements UserEventDispatcher.LaunchSourceProvider {
 
@@ -61,8 +64,18 @@ public class Hotseat extends FrameLayout
         super(context, attrs, defStyle);
         mLauncher = Launcher.getLauncher(context);
         mHasVerticalHotseat = mLauncher.getDeviceProfile().isVerticalBarLayout();
-        mBackgroundColor = ColorUtils.setAlphaComponent(
-                ContextCompat.getColor(context, R.color.all_apps_container_color), 0);
+
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            mBackgroundColor = ColorUtils.setAlphaComponent(
+                    ContextCompat.getColor(context, R.color.all_apps_container_color_light), 0);
+        } else {
+            mBackgroundColor = ColorUtils.setAlphaComponent(
+                    ContextCompat.getColor(context, R.color.all_apps_container_color), 0);
+        }
+
         mBackground = new ColorDrawable(mBackgroundColor);
         setBackground(mBackground);
     }
diff --git a/src/com/android/launcher3/IconCache.java b/src/com/android/launcher3/IconCache.java
index b273471..df40d32 100644
--- a/src/com/android/launcher3/IconCache.java
+++ b/src/com/android/launcher3/IconCache.java
@@ -52,6 +52,9 @@ import com.android.launcher3.util.ComponentKey;
 import com.android.launcher3.util.SQLiteCacheHelper;
 import com.android.launcher3.util.Thunk;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 import java.util.Collections;
 import java.util.HashMap;
 import java.util.HashSet;
@@ -114,7 +117,15 @@ public class IconCache {
 
         mWorkerHandler = new Handler(LauncherModel.getWorkerLooper());
 
-        mActivityBgColor = context.getResources().getColor(R.color.quantum_panel_bg_color);
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            mActivityBgColor = context.getResources().getColor(R.color.quantum_panel_bg_color_light);
+        } else {
+            mActivityBgColor = context.getResources().getColor(R.color.quantum_panel_bg_color);
+        }
+
         TypedArray ta = context.obtainStyledAttributes(new int[]{R.attr.colorSecondary});
         mPackageBgColor = ta.getColor(0, 0);
         ta.recycle();
diff --git a/src/com/android/launcher3/QsbContainerView.java b/src/com/android/launcher3/QsbContainerView.java
index bc64a42..d3d010b 100644
--- a/src/com/android/launcher3/QsbContainerView.java
+++ b/src/com/android/launcher3/QsbContainerView.java
@@ -38,6 +38,9 @@ import android.widget.FrameLayout;
 import com.android.launcher3.compat.AppWidgetManagerCompat;
 import com.android.launcher3.config.FeatureFlags;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 /**
  * A frame layout which contains a QSB. This internally uses fragment to bind the view, which
  * allows it to contain the logic for {@link Fragment#startActivityForResult(Intent, int)}.
@@ -177,7 +180,15 @@ public class QsbContainerView extends FrameLayout {
                 mQsb = (LauncherAppWidgetHostView)
                         widgetHost.createView(launcher, widgetId, mWidgetInfo);
                 mQsb.setId(R.id.qsb_widget);
-                mQsb.mErrorViewId = R.layout.qsb_default_view;
+
+                boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                        SettingsProvider.KEY_LIGHT, true);
+
+                if (getLight) {
+                    mQsb.mErrorViewId = R.layout.qsb_default_view_light;
+                } else {
+                    mQsb.mErrorViewId = R.layout.qsb_default_view;
+                }
 
                 if (!Utilities.containsAll(AppWidgetManager.getInstance(launcher)
                         .getAppWidgetOptions(widgetId), opts)) {
@@ -254,7 +265,17 @@ public class QsbContainerView extends FrameLayout {
         }
 
         private View getDefaultView(LayoutInflater inflater, ViewGroup parent, boolean showSetup) {
-            View v = inflater.inflate(R.layout.qsb_default_view, parent, false);
+            View v;
+
+            boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                    SettingsProvider.KEY_LIGHT, true);
+
+            if (getLight) {
+                v = inflater.inflate(R.layout.qsb_default_view_light, parent, false);
+            } else {
+                v = inflater.inflate(R.layout.qsb_default_view, parent, false);
+            }
+
             if (showSetup) {
                 View setupButton = v.findViewById(R.id.btn_qsb_setup);
                 setupButton.setVisibility(View.VISIBLE);
diff --git a/src/com/android/launcher3/allapps/AllAppsContainerView.java b/src/com/android/launcher3/allapps/AllAppsContainerView.java
index b97f8ae..847f4e8 100644
--- a/src/com/android/launcher3/allapps/AllAppsContainerView.java
+++ b/src/com/android/launcher3/allapps/AllAppsContainerView.java
@@ -344,6 +344,15 @@ public class AllAppsContainerView extends BaseContainerView implements DragSourc
         mSearchContainer = findViewById(R.id.search_container);
         mSearchInput = (ExtendedEditText) findViewById(R.id.search_box_input);
 
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            mSearchInput.setTextColor(getResources().getColor(R.color.quantum_panel_text_color_light));
+        } else {
+            mSearchInput.setTextColor(getResources().getColor(R.color.quantum_panel_text_color));
+        }
+
         // Update the hint to contain the icon.
         // Prefix the original hint with two spaces. The first space gets replaced by the icon
         // using span. The second space is used for a singe space character between the hint
diff --git a/src/com/android/launcher3/allapps/AllAppsGridAdapter.java b/src/com/android/launcher3/allapps/AllAppsGridAdapter.java
index 9fd9a39..4d5f3e8 100644
--- a/src/com/android/launcher3/allapps/AllAppsGridAdapter.java
+++ b/src/com/android/launcher3/allapps/AllAppsGridAdapter.java
@@ -206,8 +206,19 @@ public class AllAppsGridAdapter extends RecyclerView.Adapter<AllAppsGridAdapter.
             case VIEW_TYPE_ICON:
                 /* falls through */
             case VIEW_TYPE_PREDICTION_ICON: {
-                BubbleTextView icon = (BubbleTextView) mLayoutInflater.inflate(
-                        R.layout.all_apps_icon, parent, false);
+                BubbleTextView icon;
+
+                boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                        SettingsProvider.KEY_LIGHT, true);
+
+                if (getLight) {
+                    icon = (BubbleTextView) mLayoutInflater.inflate(
+                            R.layout.all_apps_icon_light, parent, false);
+                } else {
+                    icon = (BubbleTextView) mLayoutInflater.inflate(
+                            R.layout.all_apps_icon, parent, false);
+                }
+
                 icon.setOnClickListener(mIconClickListener);
                 icon.setOnLongClickListener(mIconLongClickListener);
                 icon.setLongPressTimeout(ViewConfiguration.get(parent.getContext())
@@ -224,8 +235,17 @@ public class AllAppsGridAdapter extends RecyclerView.Adapter<AllAppsGridAdapter.
                 return new ViewHolder(icon);
             }
             case VIEW_TYPE_EMPTY_SEARCH:
-                return new ViewHolder(mLayoutInflater.inflate(R.layout.all_apps_empty_search,
-                        parent, false));
+                boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                        SettingsProvider.KEY_LIGHT, true);
+
+                if (getLight) {
+                    return new ViewHolder(mLayoutInflater.inflate(R.layout.all_apps_empty_search_light,
+                            parent, false));
+                } else {
+                    return new ViewHolder(mLayoutInflater.inflate(R.layout.all_apps_empty_search,
+                            parent, false));
+                }
+
             case VIEW_TYPE_SEARCH_MARKET:
                 View searchMarketView = mLayoutInflater.inflate(R.layout.all_apps_search_market,
                         parent, false);
diff --git a/src/com/android/launcher3/allapps/AllAppsTransitionController.java b/src/com/android/launcher3/allapps/AllAppsTransitionController.java
index 865f2db..b284c46 100644
--- a/src/com/android/launcher3/allapps/AllAppsTransitionController.java
+++ b/src/com/android/launcher3/allapps/AllAppsTransitionController.java
@@ -27,6 +27,9 @@ import com.android.launcher3.Workspace;
 import com.android.launcher3.userevent.nano.LauncherLogProto;
 import com.android.launcher3.util.TouchController;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 /**
  * Handles AllApps view transition.
  * 1) Slides all apps view using direct manipulation
@@ -93,7 +96,17 @@ public class AllAppsTransitionController implements TouchController, VerticalPul
                 R.dimen.all_apps_bezel_swipe_height);
 
         mEvaluator = new ArgbEvaluator();
-        mAllAppsBackgroundColor = ContextCompat.getColor(l, R.color.all_apps_container_color);
+
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            mAllAppsBackgroundColor = ContextCompat.getColor(l, R.color.all_apps_container_color_light);
+        } else {
+            mAllAppsBackgroundColor = ContextCompat.getColor(l, R.color.all_apps_container_color);
+        }
+
+
     }
 
     @Override
diff --git a/src/com/android/launcher3/folder/Folder.java b/src/com/android/launcher3/folder/Folder.java
index 8fe50d7..8a0d5ec 100644
--- a/src/com/android/launcher3/folder/Folder.java
+++ b/src/com/android/launcher3/folder/Folder.java
@@ -84,6 +84,9 @@ import com.android.launcher3.userevent.nano.LauncherLogProto.Target;
 import com.android.launcher3.util.CircleRevealOutlineProvider;
 import com.android.launcher3.util.Thunk;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 import java.util.ArrayList;
 import java.util.Collections;
 import java.util.Comparator;
@@ -242,9 +245,19 @@ public class Folder extends LinearLayout implements DragSource, View.OnClickList
      */
     @SuppressLint("InflateParams")
     static Folder fromXml(Launcher launcher) {
-        return (Folder) launcher.getLayoutInflater().inflate(
-                FeatureFlags.LAUNCHER3_DISABLE_ICON_NORMALIZATION
-                        ? R.layout.user_folder : R.layout.user_folder_icon_normalized, null);
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            return (Folder) launcher.getLayoutInflater().inflate(
+                    FeatureFlags.LAUNCHER3_DISABLE_ICON_NORMALIZATION
+                            ? R.layout.user_folder_light: R.layout.user_folder_icon_normalized_light, null);
+        } else {
+            return (Folder) launcher.getLayoutInflater().inflate(
+                    FeatureFlags.LAUNCHER3_DISABLE_ICON_NORMALIZATION
+                            ? R.layout.user_folder : R.layout.user_folder_icon_normalized, null);
+        }
+
     }
 
     @Override
diff --git a/src/com/android/launcher3/folder/FolderPagedView.java b/src/com/android/launcher3/folder/FolderPagedView.java
index afcf6f5..f89babb 100644
--- a/src/com/android/launcher3/folder/FolderPagedView.java
+++ b/src/com/android/launcher3/folder/FolderPagedView.java
@@ -19,6 +19,7 @@ package com.android.launcher3.folder;
 import android.annotation.SuppressLint;
 import android.content.Context;
 import android.graphics.Canvas;
+import android.support.v4.content.ContextCompat;
 import android.util.AttributeSet;
 import android.util.Log;
 import android.view.Gravity;
@@ -48,6 +49,9 @@ import com.android.launcher3.keyboard.ViewGroupFocusHelper;
 import com.android.launcher3.pageindicators.PageIndicator;
 import com.android.launcher3.util.Thunk;
 
+import org.slim.launcher.SlimLauncher;
+import org.slim.launcher.settings.SettingsProvider;
+
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.Iterator;
@@ -227,8 +231,19 @@ public class FolderPagedView extends PagedView {
 
     @SuppressLint("InflateParams")
     public View createNewView(ShortcutInfo item) {
-        final BubbleTextView textView = (BubbleTextView) mInflater.inflate(
-                R.layout.folder_application, null, false);
+        final BubbleTextView textView;
+
+        boolean getLight = SettingsProvider.getBoolean(SlimLauncher.getInstance(),
+                SettingsProvider.KEY_LIGHT, true);
+
+        if (getLight) {
+            textView = (BubbleTextView) mInflater.inflate(
+                    R.layout.folder_application_light, null, false);
+        } else {
+            textView = (BubbleTextView) mInflater.inflate(
+                    R.layout.folder_application, null, false);
+        }
+
         textView.applyFromShortcutInfo(item, mIconCache);
         textView.setOnClickListener(mFolder);
         textView.setOnLongClickListener(mFolder);
diff --git a/src/org/slim/launcher/settings/GeneralFragment.java b/src/org/slim/launcher/settings/GeneralFragment.java
index d646e70..ceddf41 100644
--- a/src/org/slim/launcher/settings/GeneralFragment.java
+++ b/src/org/slim/launcher/settings/GeneralFragment.java
@@ -18,10 +18,14 @@ package org.slim.launcher.settings;
 
 import android.os.Bundle;
 
+import com.android.launcher3.R;
+
 public class GeneralFragment extends SettingsPreferenceFragment {
 
     @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
+
+        addPreferencesFromResource(R.xml.general_preferences);
     }
 }
diff --git a/src/org/slim/launcher/settings/SettingsKeys.java b/src/org/slim/launcher/settings/SettingsKeys.java
index 3aa94f3..75368cf 100644
--- a/src/org/slim/launcher/settings/SettingsKeys.java
+++ b/src/org/slim/launcher/settings/SettingsKeys.java
@@ -20,11 +20,16 @@ public interface SettingsKeys {
 
     String DEFAULT_HOMESCREEN = "default_homescreen";
 
+    // General
+    String KEY_FULLSCREEN = "show_fullscreen";
+    String KEY_LIGHT = "light_theme";
+
+
     // Homescreen
     String KEY_SHOW_SEARCH_BAR = "show_search_bar";
     String KEY_HOMESCREEN_GRID = "homescreen_grid";
     String KEY_SHOW_SHADOW = "show_shadow";
-    String KEY_FULLSCREEN = "show_fullscreen";
+
 
     // Drawer
     String KEY_DRAWER_SEARCH_ENABLED = "drawer_search_bar";
diff --git a/src/org/slim/launcher/settings/SettingsProvider.java b/src/org/slim/launcher/settings/SettingsProvider.java
index 9d2cc8f..6da064a 100644
--- a/src/org/slim/launcher/settings/SettingsProvider.java
+++ b/src/org/slim/launcher/settings/SettingsProvider.java
@@ -34,6 +34,10 @@ public class SettingsProvider implements SettingsKeys {
         return get(context).getInt(key, def);
     }
 
+    public static boolean getLight(Context context, String key, boolean def) {
+        return get(context).getBoolean(key, def);
+    }
+
     public static boolean getFullscreen(Context context, String key, boolean def) {
         return get(context).getBoolean(key, def);
     }
-- 
2.7.4

