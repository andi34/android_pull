From ef2b5bea6b72331568036788c6fcaadf63f1f178 Mon Sep 17 00:00:00 2001
From: Paul Lawrence <paullawrence@google.com>
Date: Tue, 11 Nov 2014 12:47:03 -0800
Subject: [PATCH 2/5] Fix error in clocks leading to devices staying unlocked

Use BOOTTIME consistently!

Bug: 18246810
Change-Id: I630bf39f72ab69f971d2f772e8d4545ffe467b82
---
 cryptfs.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/cryptfs.c b/cryptfs.c
index e9d6afb..2a6586b 100644
--- a/cryptfs.c
+++ b/cryptfs.c
@@ -3739,7 +3739,7 @@ int cryptfs_get_password_type(void)
 char* cryptfs_get_password()
 {
     struct timespec now;
-    clock_gettime(CLOCK_MONOTONIC, &now);
+    clock_gettime(CLOCK_BOOTTIME, &now);
     if (now.tv_sec < password_expiry_time) {
         return password;
     } else {
-- 
2.7.4

