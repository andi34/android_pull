From 1029d97b9baff536a0b5b4067b8dc05863fced54 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?D=2E=20Andrei=20M=C4=83ce=C8=99?= <dmaces@nd.edu>
Date: Tue, 24 Nov 2015 13:15:47 -0500
Subject: [PATCH 008/111] Revert "ion: export functions to enable usage by
 kernel modules"
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This reverts commit c09b24f65b5f8ec6879427be496158715c7fd4ca.

Signed-off-by: D. Andrei Măceș <dmaces@nd.edu>
---
 drivers/gpu/ion/ion.c           | 13 +------------
 drivers/gpu/ion/omap/omap_ion.c |  2 --
 2 files changed, 1 insertion(+), 14 deletions(-)

diff --git a/drivers/gpu/ion/ion.c b/drivers/gpu/ion/ion.c
index 70fdc71..bd76003 100644
--- a/drivers/gpu/ion/ion.c
+++ b/drivers/gpu/ion/ion.c
@@ -332,7 +332,6 @@ end:
 	ion_buffer_put(buffer);
 	return handle;
 }
-EXPORT_SYMBOL(ion_alloc);
 
 void ion_free(struct ion_client *client, struct ion_handle *handle)
 {
@@ -352,7 +351,6 @@ void ion_free(struct ion_client *client, struct ion_handle *handle)
 	}
 	ion_handle_put(handle);
 }
-EXPORT_SYMBOL(ion_free);
 
 static void ion_client_get(struct ion_client *client);
 static int ion_client_put(struct ion_client *client);
@@ -410,7 +408,6 @@ int ion_phys(struct ion_client *client, struct ion_handle *handle,
 	ret = buffer->heap->ops->phys(buffer->heap, buffer, addr, len);
 	return ret;
 }
-EXPORT_SYMBOL(ion_phys);
 
 void *ion_map_kernel(struct ion_client *client, struct ion_handle *handle)
 {
@@ -448,7 +445,6 @@ void *ion_map_kernel(struct ion_client *client, struct ion_handle *handle)
 	mutex_unlock(&client->lock);
 	return vaddr;
 }
-EXPORT_SYMBOL(ion_map_kernel)
 
 struct scatterlist *ion_map_dma(struct ion_client *client,
 				struct ion_handle *handle)
@@ -485,7 +481,6 @@ struct scatterlist *ion_map_dma(struct ion_client *client,
 	mutex_unlock(&client->lock);
 	return sglist;
 }
-EXPORT_SYMBOL(ion_map_dma)
 
 void ion_unmap_kernel(struct ion_client *client, struct ion_handle *handle)
 {
@@ -501,7 +496,6 @@ void ion_unmap_kernel(struct ion_client *client, struct ion_handle *handle)
 	mutex_unlock(&buffer->lock);
 	mutex_unlock(&client->lock);
 }
-EXPORT_SYMBOL(ion_unmap_kernel)
 
 void ion_unmap_dma(struct ion_client *client, struct ion_handle *handle)
 {
@@ -517,7 +511,7 @@ void ion_unmap_dma(struct ion_client *client, struct ion_handle *handle)
 	mutex_unlock(&buffer->lock);
 	mutex_unlock(&client->lock);
 }
-EXPORT_SYMBOL(ion_unmap_dma)
+
 
 struct ion_buffer *ion_share(struct ion_client *client,
 				 struct ion_handle *handle)
@@ -539,7 +533,6 @@ struct ion_buffer *ion_share(struct ion_client *client,
 	 */
 	return handle->buffer;
 }
-EXPORT_SYMBOL(ion_share)
 
 struct ion_handle *ion_import(struct ion_client *client,
 			      struct ion_buffer *buffer)
@@ -561,7 +554,6 @@ end:
 	mutex_unlock(&client->lock);
 	return handle;
 }
-EXPORT_SYMBOL(ion_import)
 
 static const struct file_operations ion_share_fops;
 
@@ -585,7 +577,6 @@ end:
 	fput(file);
 	return handle;
 }
-EXPORT_SYMBOL(ion_import_fd);
 
 static int ion_debug_client_show(struct seq_file *s, void *unused)
 {
@@ -739,7 +730,6 @@ struct ion_client *ion_client_create(struct ion_device *dev,
 
 	return client;
 }
-EXPORT_SYMBOL(ion_client_create);
 
 static void _ion_client_destroy(struct kref *kref)
 {
@@ -780,7 +770,6 @@ void ion_client_destroy(struct ion_client *client)
 {
 	ion_client_put(client);
 }
-EXPORT_SYMBOL(ion_client_destroy);
 
 static int ion_share_release(struct inode *inode, struct file* file)
 {
diff --git a/drivers/gpu/ion/omap/omap_ion.c b/drivers/gpu/ion/omap/omap_ion.c
index 9e400bd..9319fae 100644
--- a/drivers/gpu/ion/omap/omap_ion.c
+++ b/drivers/gpu/ion/omap/omap_ion.c
@@ -27,8 +27,6 @@
 #endif
 
 struct ion_device *omap_ion_device;
-EXPORT_SYMBOL(omap_ion_device);
-
 int num_heaps;
 struct ion_heap **heaps;
 struct ion_heap *tiler_heap;
-- 
2.7.4

